# Microkernel

커널은 시스템 리소스를 관리하는 운영체제의 중요한 부분이며 소프트웨어와 하드웨어 사이의 다리 역할을 한다. 커널은 부트로더 이후 시작되는 프로그램 중 하나이며 다양한 프로그램에 대한 하드웨어의 보안 액세스를 제공한다. 또한 어플리케이션이 특정 하드웨어를 사용하는 시기와 시간을 결정한다. 

<br>

### Microkernel

마이크로커널은 운영체제를 구현하기 위해 필요한 최소한의 기능, 데이터를 포함하고 있는 소프트웨어이다. 운영체제의 기본적인 기능들을 실행하기 충분한 메커니즘을 제공한다.  마이크로커널과 마이크로커널 사용자 환경은 주로 C++이나 C로 구현된다.

<br>

### Monolithic Kernel

모놀리식 커널은 프로세스 관리, 메모리 관리, 입출력 통신, 인터럽트 처리, 파일 시스템과 같은 기본적인 시스템 서비스를 단일 메모리 공간인 커널 공간에서 실행하는 기법이다. 모놀리식 커널의 접근 방식에서는 전체 운영체제는 커널모드에서 단일 프로그램으로 실행된다.  

<br>

### Microkernel Architecture

마이크로커널은 제대로된 운영체제의 구현을 위한 중요한 부분이다. 

아래 그림과 같이 마이크로커널은 메모리, 프로세스 스케줄링 메커니즘과 프로세스간의 통신과 같은 기본 작업을 수행한다.

![](https://cdn.guru99.com/images/1/121119_0439_Microkernel1.png)

마이크로커널은 커널 모드의 특권 레벨(privileged level)에서 실행되는 유일한 소프트웨어이다. CPU는 커널 모드의 특권 수준에서 시스템 메모리에 접근하며 CPU 명령을 수행한다. 디바이스 드라이버, 응용 프로그램 등의 다른 기능들은 커널 모드가 아닌 사용자 모드에서 실행된다.

<br>

### Components of Microkernel

마이크로커널은 최소한의 시스템의 핵심 기능만 포함하고 있다. 필수 구성요소가 아닌 것들은 사용자 모드로 설정해야한다.

마이크로커널에 필요한 최소한의 기능들은 다음과 같다.

- 메모리 보호 기능이 포함된 메모리 관리 
- 프로세스 및 스레드 스케줄러가 포함된 프로세서 스케줄링 
- 자체 주소 공간을 실행하는 서버를 관리하는 프로세스간 통신

<br>

### Difference Between Microkernel and Monolithic Kernel

마이크로커널과 모놀리식 커널의 차이점은 다음과 같다.

| 구분 | 마이크로커널                                                 | 모놀리식 커널                                                |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 설명 | 서버라는 별도의 프로세스로 나눌 수 있다.                     | 단일 주소 공간에서 실행되는 대규모 프로세스이다.             |
| 코드 | 마이크로커널을 작성하기 위해 더 많은 코드가 필요하다.        | 모놀리식 커널을 작성하기 위해 더 적은 코드가 필요하다.       |
| 보안 | 서비스가 충돌하더라도 마이크로커널의 작동에는 영향을 끼치지않는다. | 서비스가 충돌하면 전체 시스템이 모놀리식 커널에서 전체 시스템이 collapse된다. |
| 통신 | 서버는 IPC를 통해 통신한다.                                  | 단일 정적 바이너리 파일                                      |
| 예   | L4Linux, Mac OS X 등                                         | Linux, Windows(95, 98 등), DOS, AIX 등                       |

<br>

### Advantages of Microkernel

마이크로커널의 장점은 다음과 같다.

- 마이크로커널 아키텍처는 작고 세분화되어 있으며 작동성이 좋다.
- 안전성이 보장된다.
- 시스템 확장이 쉽고 커널을 방해하지 않고 시스템 응용 프로그램에 추가할 수 있다.
- 마이크로커널은 모듈식이며 커널의 조작 없이 교체, 불러오기 및 수정이 가능하다.
- 모놀리식커널 시스템과 비교해 시스템 충돌이 적다.
- 보안 및 안정성이 확보되면 커널 모드에서 실행되는 코드 양이 적어진다.
- 리컴파일 없이 새로운 기능을 추가할 수 있다.

마이크로커널은 많은 장점을 가지고 있지만 일반적인 모놀리식 시스템과 비교해 비용이 많이 든다는 단점도 있다.

<br>

<br>

------

##### Reference

- [Microkernel in Operating System: Architecture, Advantages](https://www.guru99.com/microkernel-in-operating-systems.html)
- [[운영체제 I/O Protection] 유저(User) 모드 vs 커널(Kernel) 모드](https://jhnyang.tistory.com/190)

